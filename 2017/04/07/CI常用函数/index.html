<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="PHP," />








  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?v=5.1.0" />






<meta name="description" content="选择数据$this-&amp;gt;db-&amp;gt;select();允许你在SQL查询中写 SELECT 部分。$this-&amp;gt;db-&amp;gt;where();$this-&amp;gt;db-&amp;gt;or_where();$this-&amp;gt;db-&amp;gt;where_in();">
<meta property="og:type" content="article">
<meta property="og:title" content="CI常用函数">
<meta property="og:url" content="http://yoursite.com/2017/04/07/CI常用函数/index.html">
<meta property="og:site_name" content="Seas0n">
<meta property="og:description" content="选择数据$this-&amp;gt;db-&amp;gt;select();允许你在SQL查询中写 SELECT 部分。$this-&amp;gt;db-&amp;gt;where();$this-&amp;gt;db-&amp;gt;or_where();$this-&amp;gt;db-&amp;gt;where_in();">
<meta property="og:updated_time" content="2017-04-07T08:38:53.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CI常用函数">
<meta name="twitter:description" content="选择数据$this-&amp;gt;db-&amp;gt;select();允许你在SQL查询中写 SELECT 部分。$this-&amp;gt;db-&amp;gt;where();$this-&amp;gt;db-&amp;gt;or_where();$this-&amp;gt;db-&amp;gt;where_in();">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"hide","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/04/07/CI常用函数/"/>





  <title> CI常用函数 | Seas0n </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  





  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?21d25a2d305d730d5986940ccb294463";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>










  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Seas0n</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description"></h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-guestbook">
          <a href="/guestbook" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br />
            
            留言
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>
    s
    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  
  <style>
    .from{
        border-radius: 50px;
        width: 25px;
        height: 25px;
        display: inline-block;
        text-align: center;
        margin-left: 6px;
        line-height: 25px;
        position: relative;
        top: -2px;
        font-size: 17px;
    }
    .fromMe{
        color: #FB7081;
        border: 2px solid #FB7081;

    }
    .fromOther{
        color: #8284E9;
        border: 2px solid #8284E9;
    }
  </style>
  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/04/07/CI常用函数/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Seas0n">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/user.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Seas0n">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
            
            
              
                CI常用函数
                
                  <span class="from fromOther">转</span>
                
              
            
          </h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-07T16:33:59+08:00">
                2017-04-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/PHP/" itemprop="url" rel="index">
                    <span itemprop="name">PHP</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a class="cloud-tie-join-count" href="/2017/04/07/CI常用函数/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count join-count" itemprop="commentCount"></span>
                </a>
                <span class="post-meta-item-text">条 </span>
              </span>
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> 浏览
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>次
            </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="选择数据"><a href="#选择数据" class="headerlink" title="选择数据"></a><code>选择数据</code></h4><p>$this-&gt;db-&gt;select();<br>允许你在SQL查询中写 SELECT 部分。<br>$this-&gt;db-&gt;where();<br>$this-&gt;db-&gt;or_where();<br>$this-&gt;db-&gt;where_in();<br><a id="more"></a><br>允许你在SQL查询中写 WHERE部分，其余各种where语句请看手册。<br>$this-&gt;db-&gt;get();<br>运行选择查询语句并且返回结果集。可以获取一个表的全部数据。<br>$this-&gt;db-&gt;like();<br>$this-&gt;db-&gt;or_like();<br>$this-&gt;db-&gt;not_like();<br>本函数允许你生成 LIKE 子句，在做查询时非常有用，其余语法请看手册。<br>$this-&gt;db-&gt;order_by();<br>帮助你设置一个 ORDER BY 子句。<br>$this-&gt;db-&gt;group_by();<br>允许你编写查询语句中的 GROUP BY 部分:<br>$this-&gt;db-&gt;distinct();<br>为查询语句添加 “DISTINCT” 关键字:<br>$this-&gt;db-&gt;having();<br>允许你为你的查询语句编写 HAVING 部分。<br>$this-&gt;db-&gt;limit();<br>限制查询所返回的结果数量:<br>$this-&gt;db-&gt;select_max();<br>为你的查询编写一个 “SELECT MAX(field)”。<br>$this-&gt;db-&gt;select_min();<br>为你的查询编写一个 “SELECT MIN(field)” 。<br>$this-&gt;db-&gt;select_avg();<br>为你的查询编写一个 “SELECT AVG(field)” 。<br>$this-&gt;db-&gt;select_sum();<br>为你的查询编写一个 “SELECT SUM(field)” 。<br>$this-&gt;db-&gt;join();<br>允许你编写查询中的JOIN部分。<br>$this-&gt;db-&gt;count_all_results();<br>允许你获得某个特定的Active Record查询所返回的结果数量。可以使用Active Record限制函数，例如 where(), or_where(), like(), or_like() 等等。</p>
<h4 id="插入数据"><a href="#插入数据" class="headerlink" title="插入数据"></a><code>插入数据</code></h4><p>$this-&gt;db-&gt;insert();<br>生成一条基于你所提供的数据的SQL插入字符串并执行查询。你可以向函数传递 数组 或一个 对象。<br>$this-&gt;db-&gt;insert_batch();<br>一次插入多条数据，生成一条基于你所提供的数据的SQL插入字符串并执行查询。你可以向函数传递 数组 或一个 对象。<br>$this-&gt;db-&gt;set();<br>本函数使您能够设置inserts(插入)或updates(更新)值。它可以用来代替那种直接传递数组给插入和更新函数的方式。</p>
<h4 id="更新数据"><a href="#更新数据" class="headerlink" title="更新数据"></a><code>更新数据</code></h4><p>$this-&gt;db-&gt;update();<br>根据你提供的数据生成并执行一条update(更新)语句。你可以将一个数组或者对象传递给本函数。<br>$this-&gt;db-&gt;update_batch();<br>Generates an update string based on the data you supply, and runs the query. You can either pass an array or an object to the function. Here is an example using an array:</p>
<h4 id="删除数据"><a href="#删除数据" class="headerlink" title="删除数据"></a><code>删除数据</code></h4><p>$this-&gt;db-&gt;delete();<br>生成并执行一条DELETE(删除)语句。<br>$this-&gt;db-&gt;empty_table();<br>生成并执行一条DELETE(删除)语句。<br>$this-&gt;db-&gt;truncate();<br>生成并执行一条TRUNCATE(截断)语句。</p>
<p><code>链式方法</code></p>
<p>链式方法允许你以连接多个函数的方式简化你的语法。考虑一下这个范例:<br>$this-&gt;db-&gt;select(‘title’)-&gt;from(‘mytable’)-&gt;where(‘id’, $id)-&gt;limit(10, 20);<br>$query = $this-&gt;db-&gt;get();<br>说明: 链式方法只能在PHP 5下面运行。</p>
<p><code>查询</code></p>
<p>$this-&gt;db-&gt;query();<br>要提交一个查询，用以下函数：<br>$this-&gt;db-&gt;query(‘YOUR QUERY HERE’);<br>query() 函数以object(对象)的形式返回一个数据库结果集。 当使用 “read” 模式来运行查询时, 你可以使用“显示你的结果集”来显示查询结果; 当使用 “write” 模式来运行查询时, 将会仅根据执行的成功或失败来返回 TRUE 或 FALSE.</p>
<h4 id="转义查询"><a href="#转义查询" class="headerlink" title="转义查询"></a><code>转义查询</code></h4><p>$this-&gt;db-&gt;escape()这个函数将会确定数据类型，以便仅对字符串类型数据进行转义。并且，它也会自动把数据用单引号括起来，所以你不必手动添加单引号，用法如下：  $sql = “INSERT INTO table (title) VALUES(“.$this-&gt;db-&gt;escape($title).”)”;</p>
<h4 id="查询辅助函数"><a href="#查询辅助函数" class="headerlink" title="查询辅助函数"></a><code>查询辅助函数</code></h4><p>$this-&gt;db-&gt;insert_id()<br>这个ID号是执行数据插入时的ID。<br>$this-&gt;db-&gt;affected_rows()<br>当执行写入操作（insert,update等）的查询后，显示被影响的行数。<br>$this-&gt;db-&gt;count_all();<br>计算出指定表的总行数并返回。在第一个参数中写入被提交的表名。</p>
<h4 id="生成查询记录集"><a href="#生成查询记录集" class="headerlink" title="生成查询记录集"></a><code>生成查询记录集</code></h4><p>result()<br>该方法执行成功返回一个object 数组，失败则返回一个空数组。<br>result_array()<br>该方法执行成功时将记录集作为关联数组返回。失败时返回空数组。<br>row()<br>该函数将当前请求的第一行数据作为 object 返回。</p>
<p>你可以传递参数(参数是行的索引)以便获得某一行的数据。比如我们要获得第 5 行的数据： $row = $query-&gt;row(4);</p>
<p>row_array()<br>功能与 row() 一样, 区别在于该函数返回的是一个数组。<br>除此以外, 我们还可以使用下面的方法通过游标的方式获取记录：<br>$row = $query-&gt;first_row()<br>$row = $query-&gt;last_row()<br>$row = $query-&gt;next_row()<br>$row = $query-&gt;previous_row()<br>默认情况下他们将返回一个 object，同时你也可以传递参数 “array” 以便使用 array 的方式获取数据 $row = $query-&gt;first_row(‘array’)<br>$row = $query-&gt;last_row(‘array’)<br>$row = $query-&gt;next_row(‘array’)<br>$row = $query-&gt;previous_row(‘array’)</p>
<h4 id="结果集辅助函数"><a href="#结果集辅助函数" class="headerlink" title="结果集辅助函数"></a><code>结果集辅助函数</code></h4><p>$query-&gt;num_rows()<br>该函数将会返回当前请求的行数。<br>$query-&gt;num_fields()<br>该函数返回当前请求的字段数（列数）：<br>$query-&gt;free_result()<br>该函数将会释放当前查询所占用的内存并删除其关联的资源标识。</p>
<p><code>自动连接</code></p>
<p>“自动连接” 功能将在每个一页面加载时被自动实例化数据库类。要启用“自动连接”，可在application/config/autoload.php中的 library 数组里添加 database：<br>$autoload[‘libraries’] = array(‘database’);</p>
<p><code>手动连接</code></p>
<p>如果仅仅是一部分页面要求数据库连接，你可以在你有需要的函数里手工添加如下代码或者在你的类里手工添加以供该类使用。<br>$this-&gt;load-&gt;database();</p>
<p><code>连接多数据库</code></p>
<p>如果你需要同时连接多于一个的数据库，你可以用以下方式来实现：<br>$DB1 = $this-&gt;load-&gt;database(‘group_one’, TRUE);<br>$DB2 = $this-&gt;load-&gt;database(‘group_two’, TRUE);</p>
<p><code>表数据</code></p>
<p>$this-&gt;db-&gt;list_tables();<br>返回一个包含当前连接数据库中所有表名称的数组。<br>$this-&gt;db-&gt;table_exists();<br>有时，在对某个表执行操作之前，使用该函数判断指定表是否存在很有用。返回一个布尔值。</p>
<p><code>数据库工具类</code></p>
<p>重要提示：  初始化数据库工具类之前，你的数据库驱动必须已经运行,因为工具类依赖于此。<br>加载工具类： $this-&gt;load-&gt;dbutil()<br>一旦初始化完毕，你可以通过 $this-&gt;dbutil 对象来访问成员函数：<br>$this-&gt;dbutil-&gt;list_databases()<br>$this-&gt;dbutil-&gt;database_exists();<br>$this-&gt;dbutil-&gt;xml_from_result($db_result)<br>$this-&gt;dbutil-&gt;backup()</p>
<p><code>数据库缓存类</code></p>
<p>激活缓存需要三步：<br>1、在服务器上创建一个可写的目录以便保存缓存文件。<br>2、在文件 application/config/database.php 中$db[‘xxxx’][‘cachedir’]设置其目录。<br>3、激活缓存特性，可以在文件 application/config/database.php 中设置全局选项$db[‘xxxx’][‘cache_on’]=’TRUE’，也可以用以本页下面的方法手动设置。<br>一旦被激活，每一次含有数据库查询的页面被加载时缓存就会自动发生。</p>
<p>当有数据库更新，我们需要删除缓存文件<br>$this-&gt;db-&gt;cache_delete()<br>删除缓存文件与特定网页。如果你需要清除缓存后，更新您的数据库<br>$this-&gt;db-&gt;cache_delete(‘/blog’, ‘comments’);<br>注意，手册上写的是 $this-&gt;db-&gt;cache_delete(‘blog’, ‘comments’);但根据实际测试应该在控制器名字前加斜杠’/‘才能正确执行。<br>$this-&gt;db-&gt;cache_delete_all()<br>清除所有所有的缓存文件。</p>
<p><code>数据库维护类</code></p>
<p>注意:  欲初始化数据库维护类，请确保你的数据库驱动已经运行，因为该类依赖于数据库驱动。<br>使用如下方法载入数据库维护类:<br>$this-&gt;load-&gt;dbforge()<br>一旦初始化，就可以使用$this-&gt;dbforge 对象访问类中函数:<br>$this-&gt;dbforge-&gt;create_database(‘db_name’)<br>允许你创建由第一个参数指定的数据库。<br>$this-&gt;dbforge-&gt;drop_database(‘db_name’)<br>允许你删除由第一个参数指定的数据库。<br>$this-&gt;dbforge-&gt;create_table(‘table_name’);<br>声明了字段和键之后，你就可以创建一个表。  </p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/PHP/" rel="tag"># PHP</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/07/前端知识点2/" rel="next" title="前端知识点2">
                <i class="fa fa-chevron-left"></i> 前端知识点2
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/04/07/shell-命令大全/" rel="prev" title="shell 命令大全">
                shell 命令大全 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/user.jpg"
               alt="Seas0n" />
          <p class="site-author-name" itemprop="name">Seas0n</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
           
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">35</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">26</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">28</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/seasonsu" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github-alt"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="http://wpa.qq.com/msgrd?v=3&uin=459705913&site=qq&menu=yes" target="_blank" title="QQ">
                  
                    <i class="fa fa-fw fa-qq"></i>
                  
                  QQ
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#选择数据"><span class="nav-number">1.</span> <span class="nav-text">选择数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#插入数据"><span class="nav-number">2.</span> <span class="nav-text">插入数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#更新数据"><span class="nav-number">3.</span> <span class="nav-text">更新数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#删除数据"><span class="nav-number">4.</span> <span class="nav-text">删除数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#转义查询"><span class="nav-number">5.</span> <span class="nav-text">转义查询</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查询辅助函数"><span class="nav-number">6.</span> <span class="nav-text">查询辅助函数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#生成查询记录集"><span class="nav-number">7.</span> <span class="nav-text">生成查询记录集</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#结果集辅助函数"><span class="nav-number">8.</span> <span class="nav-text">结果集辅助函数</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        
</script>
<div class="copyright" >
  <span class="author" itemprop="copyrightHolder"> 欢迎来到Seas0n的博客</span>
  <br>
  <span class="author" itemprop="copyrightHolder"> PS: 本博客用于日常记录，并非全部原创</span>
</div>

        

<div class="busuanzi-count">

  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv"><i class="fa fa-user"></i> 你是第<span class="busuanzi-value" id="busuanzi_value_site_uv"></span>位旅客</span>
  

  
    <span class="site-pv"><i class="fa fa-eye"></i>  总访问量<span class="busuanzi-value" id="busuanzi_value_site_pv"></span>次</span>
  
  
</div>



        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  
    
    <script>
        if($('.page-post-detail').length > 0 || window.location.href.indexOf('guestbook') > -1){
            var cloudTieConfig = {
              url: document.location.href,
              sourceId: "",
              productKey: "f9d61c652aaf4321a1ab5f4ba944d9af",
              target: "cloud-tie-wrapper"
            };
           var oHead = document.getElementsByTagName('head').item(0);
           var oScript = document.createElement('script');
           oScript.type = 'text/javascript';
           oScript.src = 'https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js';
           oHead.appendChild(oScript);
        }
    </script>

  








  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  


  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  


  



</body>
</html>
